# MPV Configuration
# clean up input config (helps with iina, gnome-mpv etc.)
# no-input-default-bindings
autoload-files=no
input-ipc-server=/var/run/user/1000/mpv 
autofit-larger=90%x90%
profile=gpu-hq

#
# Video
#
framedrop=vo
video-sync=display-resample
gpu-context=wayland
window-maximized=yes # prevent wayland problems with buffer resize
hwdec=yes

#
# Audio
#
alang=jpn,ja,eng,en,ger,de
volume-max=200
audio-channels=auto-safe
# bs2b filter
# af-add=lavfi=[bs2b=profile=jmeier] #default,cmoy

#
# Subtitles
#
slang=eng,en,ger,de
sub-font="Rosario"
sub-bold=yes
# sub-ass-force-style=Kerning=yes

#
# OSD
#
osc=no
osd-bar=no
border=no
#
keep-open=yes
stop-screensaver=yes
cursor-autohide-fs-only
osd-font="Iosevka Sparkle"
# osd-font=monospace
osd-font-size=15
osd-scale-by-window=yes
osd-fractions=yes
geometry=50%x50%
hidpi-window-scale
load-stats-overlay=yes
load-osd-console=yes

#
# Misc.
#
screenshot-directory=~/Pictures/screenshots/mpv
screenshot-template='%tY%tm%td-%tH%tM%tS-%F-%p'
# screenshot-format=png
# screenshot-jpeg-quality=100
# user-agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:42.0) Gecko/20100101 Firefox/42.0"
# ytdl-format=bestvideo+bestaudio,best

#
# PROFILES
#

[anime]
profile-desc="Optimized for watching anime with ASS subtitles"
sub-auto=fuzzy
deband=yes
# sub-border-size=2
# sub-font-size=45
# sub-margin-y=50
# sub-spacing=1
ordered-chapters-files=/tmp/mpv_ordered_chapters

[webcam]
profile-desc="Optimized for showing internal webcam feed"
osc=no
profile=low-latency
# video-sync=display-desync # needed or external audio will fail
pulse-latency-hacks=yes
demuxer-lavf-o=input_format=mjpeg,video_size=848x480
# framedrop=no
# no-demuxer-thread
opengl-glfinish=yes
opengl-swapinterval=0
vf=hflip

[protocol.http]
profile-desc="Optimized for streaming video"
glsl-shaders-clr
title="${media-title}"
ytdl-format=bestvideo[height<=?1080]+bestaudio/best[height<=?1080]
demuxer-seekable-cache=yes
demuxer-max-bytes=2048MiB
demuxer-max-back-bytes=1024MiB
script=~/.config/mpv/scripts/mpv-plugin-streamcache/streamcache.lua

[protocol.https]
profile=protocol.http

[cache]
profile=protocol.http

[scale]
glsl-shaders-clr
scale=ewa_lanczossharp
cscale=ewa_lanczossharp
dscale=ewa_lanczossharp
correct-downscaling=yes
sigmoid-upscaling=yes

[gpuscale8]
profile-desc="Use GLSL shaders to scale via GPU"
profile=gpu-hq
glsl-shaders=~~/shaders/FSRCNNX_x2_16-0-4-1.glsl

[gpuscale16]
profile-desc="Use GLSL shaders to scale via GPU"
profile=gpu-hq
glsl-shaders=~~/shaders/FSRCNNX_x2_8-0-4-1.glsl

[interpolate]
profile-desc="Increase framecount by interpolating (with vapoursynth)"
profile=gpu-hq
vf=format=yuv420p,vapoursynth=~~/vapoursynth/interpolate.vpy:4:4

[svp]
# Everything below here only applies to this profile until another profile is declared!
input-ipc-server=/tmp/mpvsocket     # Receives input from SVP
hr-seek-framedrop=no                # Fixes audio desync
resume-playback=no                  # Not compatible with SVP
hwdec=auto-copy
hwdec-codecs=all
autofit-larger=100%x100%
# video-sync=desync
video-sync=display-resample

[reset]
load-scripts=no
osc=yes
osd-bar=yes

[3d]
vf-add=stereo3d:ab2l:ml
